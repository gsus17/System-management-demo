<div fxFlex
     fxLayout="column"
     fxLayoutAlign="center center">

  <mat-toolbar color="primary">
    <span class="mat-title">{{viewdata.titleForm | translate}}</span>
  </mat-toolbar>
  <div class="general-container form-container"
       fxFlexLayout="row"
       fxLayoutAlign="center center">
    <mat-card class="card-form"
              fxFlex>
      <mat-card-title i18n>
        {{'PERSON_FORM_TITLE' | translate}}
      </mat-card-title>
      <mat-card-content>

        <form [formGroup]="personForm"
              fxFlex
              fxLayout="column">
          <section fxLayout="column">
            <div fxLayout="row">

              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="name"
                       formControlName="name"
                       [(ngModel)]="formulario.name"
                       placeholder="{{'PERSON_FORM_COMPLETED_USER_LABEL' | translate}}">
                <mat-hint align="start">
                  <span i18n>{{'PERSON_FORM_USER_HINT' | translate}}</span>
                </mat-hint>
                <mat-error *ngIf="validateError('name') && getErrors('name').required"
                           i18n>
                  {{'PERSON_FORM_USER_ERROR' | translate}}
                </mat-error>
              </mat-form-field>
            </div>
            <div fxLayout="row">
              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="email"
                       formControlName="email"
                       [(ngModel)]="formulario.email"
                       placeholder="{{'PERSON_FORM_EMAIL_PLACEHOLDER' | translate}}">
                <mat-error *ngIf="validateError('email') && getErrors('email').required"
                           i18n>
                  {{'PERSON_FORM_EMAIL_ERROR' | translate}}
                </mat-error>
              </mat-form-field>
            </div>

            <div fxLayout="column"
                 class="custom-container">
              <div fxLayout="row"
                   fxLayout.xs="column">
                <mat-form-field class="example-full-width">
                  <input matInput
                         name="ahorro"
                         formControlName="ahorro"
                         [(ngModel)]="formulario.ahorro"
                         type="number"
                         placeholder="{{'PERSON_FORM_AHORRO_PLACEHOLDER' | translate}}">
                </mat-form-field>
                <mat-form-field class="example-full-width">
                  <input matInput
                         name="ahorroPercentage"
                         type="number"
                         formControlName="ahorroPercentage"
                         [(ngModel)]="formulario.ahorroPercentage"
                         placeholder="{{'PERSON_FORM_PERCENTAGE_PLACEHOLDER' | translate}}">
                </mat-form-field>

                <mat-slide-toggle class="toggle-container"
                                  formControlName="enableNotify"
                                  [(ngModel)]="formulario.enableNotify"
                                  fxFlex
                                  i18n>{{'PERSON_FORM_NOTIFICATION_LABEL' | translate}}</mat-slide-toggle>
              </div>
              <span fxShow.xs="false"
                    fxShow.sm="false"
                    fxShow.md="false"
                    class="custom-hint not-separated"> {{'PERSON_FORM_AHORRO_AND_PERCENTAGE_HINT' | translate}}
              </span>
            </div>

            <div fxLayout="row">
              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="address"
                       formControlName="address"
                       [(ngModel)]="formulario.address"
                       placeholder="{{'PERSON_FORM_ADDRESS_PLACEHOLDER' | translate}}">
              </mat-form-field>
            </div>
            <div fxLayout="row"
                 fxLayout.xs="column">

              <mat-form-field class="birthdate-container">
                <input matInput
                       name="birthdate"
                       formControlName="birthdate"
                       [(ngModel)]="formulario.birthdate"
                       [matDatepicker]="picker"
                       placeholder="{{'PERSON_FORM_BIRTHDAY_PLACEHOLDER' | translate}}">
                <mat-datepicker-toggle matSuffix
                                       [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>

              <mat-form-field>
                <mat-select placeholder="Sexo"
                            name="gender"
                            formControlName="gender"
                            [(ngModel)]="formulario.gender">
                  <mat-option *ngFor="let sexos of viewdata.sexos"
                              [value]="sexos">
                    {{sexos}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field>
                <mat-select placeholder="{{'PERSON_FORM_STATUS_PLACEHOLDER' | translate}}"
                            name="status"
                            formControlName="status"
                            [(ngModel)]="formulario.status">
                  <mat-option *ngFor="let accountStatusList of viewdata.accountStatusList"
                              [value]="accountStatusList">
                    {{accountStatusList}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </section>

          <section fxLayout="column">
            <mat-accordion [multi]="true">
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title i18n>
                    {{'PERSON_FORM_REGIONAL_DATA_PLACEHOLDER' | translate}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <section fxLayout="column">
                  <div fxLayout="row"
                       fxLayout.xs="column">
                    <mat-form-field>
                      <mat-select placeholder="{{'PERSON_FORM_DATE_FORMAT_PLACEHOLDER' | translate}}"
                                  name="dateFormat"
                                  formControlName="dateFormat"
                                  [(ngModel)]="formulario.regionalData.dateFormat">
                        <mat-option *ngFor="let dateFormats of viewdata.dateFormats"
                                    [value]="dateFormats">
                          {{dateFormats}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-select placeholder="{{'PERSON_FORM_HOUR_FORMAT_PLACEHOLDER' | translate}}"
                                  name="timeFormat"
                                  formControlName="timeFormat"
                                  [(ngModel)]="formulario.regionalData.timeFormat">
                        <mat-option *ngFor="let timeFormats of viewdata.timeFormats"
                                    [value]="timeFormats">
                          {{timeFormats}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <mat-form-field>
                      <mat-select placeholder="{{'PERSON_FORM_ZONE_PLACEHOLDER' | translate}}"
                                  name="timeZone"
                                  formControlName="timeZone"
                                  [(ngModel)]="formulario.regionalData.timeZone">
                        <mat-option *ngFor="let timeZones of viewdata.timeZones"
                                    [value]="timeZones.timeZoneId">
                          {{timeZones.timeZoneName}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div fxLayout="row"
                       fxLayout.xs="column">
                    <div fxLayout="row"
                         fxFlex="39">
                      <mat-form-field fxFlex>
                        <mat-select placeholder="{{'PERSON_FORM_NATIONALITY_PLACEHOLDER' | translate}}"
                                    formControlName="nacionalidad"
                                    [(ngModel)]="formulario.nacionalidad">
                          <mat-option *ngFor="let countrie of viewdata.countries"
                                      [value]="countrie.nombre">
                            {{countrie.nombre}}
                          </mat-option>
                        </mat-select>
                      </mat-form-field>
                      <button class="not-separated"
                              mat-icon-button
                              (click)="addCountry($index)">
                        <mat-icon>add_circle_outline</mat-icon>
                      </button>
                    </div>
                    <mat-form-field>
                      <mat-select placeholder="{{'PERSON_FORM_LANGUAGE_PLACEHOLDER' | translate}}"
                                  name="languageCode"
                                  formControlName="languageCode"
                                  [(ngModel)]="formulario.regionalData.languageCode">
                        <mat-option *ngFor="let languageCodes of viewdata.languageCodes"
                                    [value]="languageCodes">
                          {{languageCodes}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </section>

              </mat-expansion-panel>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title i18n>
                    {{'PERSON_FORM_PROPERIES_TITLE' | translate}}
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-card>
                  <mat-card-content>
                    <mat-list *ngIf="hasBienes()"
                              fxLayout="column"
                              fxFlex
                              fxLayoutAlign="space-between center">
                      <mat-list-item *ngFor="let bien of formulario.bienes; $index as i"
                                     fxFlex>
                        <div fxLayout="row"
                             fxLayoutAlign="start center"
                             fxFlex>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.descripcion}}</div>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.tipo}}</div>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.valor | currency}}</div>
                          <div fxLayout="row"
                               fxFlex="10%"
                               fxLayoutAlign="center center">
                            <button mat-icon-button
                                    (click)="deleteBien($index)">
                              <mat-icon>delete_forever</mat-icon>
                            </button>
                          </div>
                        </div>
                      </mat-list-item>
                    </mat-list>

                    <span *ngIf="!hasBienes()"
                          i18n>{{'PERSON_FORM_PROPERIES_EMPTY' | translate}}</span>

                  </mat-card-content>
                </mat-card>
                <div class="agregar-bien-container">
                  <div fxLayout="row"
                       fxLayoutAlign="start center">
                    <button mat-button
                            (click)="openDialog()">
                      <mat-icon>add_circle_outline</mat-icon>
                      <span class="agregar-bien-label"
                            i18n>{{'PERSON_FORM_PROPERIES_ADD' | translate}}</span>
                    </button>
                  </div>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </section>

          <section fxLayout="column">
            <div fxLayout="row">
              <mat-form-field fxFlex>
                <mat-label i18n>{{'PERSON_FORM_COMMENTS_LABEL' | translate}}</mat-label>
                <textarea matInput
                          cdkTextareaAutosize
                          cdkAutosizeMinRows="2"
                          name="obs"
                          maxlength="255"
                          formControlName="obs"
                          [(ngModel)]="formulario.obs"
                          cdkAutosizeMaxRows="5"></textarea>
                <mat-hint align="end">{{formulario.obs.length}} / 255</mat-hint>
              </mat-form-field>
            </div>
          </section>

          <div fxFlexLayout="row"
               fxLayoutAlign="end center">
            <div class="button-container">
              <button mat-raised-button
                      (click)="cancel()"
                      i18n>{{'PERSON_FORM_CANCEL_BUTTON' | translate}}</button>
            </div>
            <div class="button-container">
              <button mat-raised-button
                      [disabled]="personForm.invalid"
                      (click)="action()"
                      color="primary">{{viewdata.buttonActionText | translate}}</button>
            </div>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>

</div>
