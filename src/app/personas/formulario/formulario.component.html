<div fxFlex
     fxLayout="column"
     fxLayoutAlign="center center">

  <mat-toolbar color="primary">
    <span class="mat-title">{{viewdata.titleForm}}</span>
  </mat-toolbar>
  <div class="general-container form-container"
       fxFlexLayout="row"
       fxLayoutAlign="center center">
    <mat-card class="card-form">
      <mat-card-title i18n>
        Formulario de Personas
      </mat-card-title>
      <mat-card-content>

        <form [formGroup]="personForm"
              fxLayout="column">
          <div>
            <div fxLayout="row">
              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="name"
                       formControlName="name"
                       [(ngModel)]="formulario.name"
                       placeholder="Nombre Completo">
                <mat-hint align="start"><strong i18n>Con el siguiente formato Apellido, Nombre/s.</strong> </mat-hint>
                <mat-error *ngIf="validateError('name') && getErrors('name').required"
                           i18n>
                  Debe ingresar el nombre completo.
                </mat-error>
              </mat-form-field>
            </div>
            <div fxLayout="row">
              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="email"
                       formControlName="email"
                       [(ngModel)]="formulario.email"
                       placeholder="Correo electronico">
                <mat-error *ngIf="validateError('email') && getErrors('email').required"
                           i18n>
                  Debe ingresar el correo electr√≥nico.
                </mat-error>
              </mat-form-field>
            </div>
            <div fxLayout="row">
              <table fxLayout="row"
                     fxFlex
                     cellspacing="5">
                <tr>
                  <td>
                    <mat-form-field class="example-full-width">
                      <input matInput
                             name="ahorro"
                             formControlName="ahorro"
                             [(ngModel)]="formulario.ahorro"
                             type="number"
                             placeholder="Ahorro">
                    </mat-form-field>
                  </td>
                  <td>
                    <mat-form-field class="example-full-width">
                      <input matInput
                             name="ahorroPercentage"
                             type="number"
                             formControlName="ahorroPercentage"
                             [(ngModel)]="formulario.ahorroPercentage"
                             placeholder="Porcentaje">
                    </mat-form-field>
                  </td>
                  <td>
                    <mat-slide-toggle class="toggle-container"
                                      formControlName="enableNotify"
                                      [(ngModel)]="formulario.enableNotify"
                                      fxFlex
                                      i18n>Recibir notificaciones</mat-slide-toggle>
                  </td>
                </tr>
              </table>
            </div>
            <div fxLayout="row">
              <mat-form-field fxFlex
                              class="example-full-width">
                <input matInput
                       name="address"
                       formControlName="address"
                       [(ngModel)]="formulario.address"
                       placeholder="Direccion">
              </mat-form-field>
            </div>
            <div fxLayout="row">
              <table fxLayout="row"
                     fxFlex
                     cellspacing="5">
                <tr>
                  <td>
                    <mat-form-field class="birthdate-container">
                      <input matInput
                             name="birthdate"
                             formControlName="birthdate"
                             [(ngModel)]="formulario.birthdate"
                             [matDatepicker]="picker"
                             placeholder="Fecha de nacimiento">
                      <mat-datepicker-toggle matSuffix
                                             [for]="picker"></mat-datepicker-toggle>
                      <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                  </td>
                  <td>
                    <mat-form-field>
                      <mat-select placeholder="Sexo"
                                  name="gender"
                                  formControlName="gender"
                                  [(ngModel)]="formulario.gender">
                        <mat-option *ngFor="let sexos of viewdata.sexos"
                                    [value]="sexos">
                          {{sexos}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </td>
                  <td>
                    <mat-form-field>
                      <mat-select placeholder="Estado"
                                  name="status"
                                  formControlName="status"
                                  [(ngModel)]="formulario.status">
                        <mat-option *ngFor="let accountStatusList of viewdata.accountStatusList"
                                    [value]="accountStatusList">
                          {{accountStatusList}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </td>
                </tr>
              </table>
            </div>
          </div>
          <!-- <mat-divider></mat-divider> -->
          <div>
            <mat-accordion>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title i18n>
                    Datos regionales
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <div fxLayout="column">
                  <div fxLayout="row">
                    <table fxLayout="row"
                           fxFlex
                           cellspacing="5">
                      <tr>
                        <td>
                          <mat-form-field>
                            <mat-select placeholder="Formato de fecha"
                                        name="dateFormat"
                                        formControlName="dateFormat"
                                        [(ngModel)]="formulario.regionalData.dateFormat">
                              <mat-option *ngFor="let dateFormats of viewdata.dateFormats"
                                          [value]="dateFormats">
                                {{dateFormats}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </td>
                        <td>
                          <mat-form-field>
                            <mat-select placeholder="Formato de hora"
                                        name="timeFormat"
                                        formControlName="timeFormat"
                                        [(ngModel)]="formulario.regionalData.timeFormat">
                              <mat-option *ngFor="let timeFormats of viewdata.timeFormats"
                                          [value]="timeFormats">
                                {{timeFormats}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </td>
                        <td>
                          <mat-form-field>
                            <mat-select placeholder="Zona Horaria"
                                        name="timeZone"
                                        formControlName="timeZone"
                                        [(ngModel)]="formulario.regionalData.timeZone">
                              <mat-option *ngFor="let timeZones of viewdata.timeZones"
                                          [value]="timeZones.timeZoneId">
                                {{timeZones.timeZoneName}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </td>
                      </tr>
                    </table>
                  </div>

                  <div fxLayout="row">
                    <table fxLayout="row"
                           fxFlex
                           cellspacing="5">
                      <tr>
                        <td>
                          <mat-form-field>
                            <mat-select placeholder="Nacionalidad"
                                        formControlName="nacionalidad"
                                        [(ngModel)]="formulario.nacionalidad">
                              <mat-option *ngFor="let countrie of viewdata.countries"
                                          [value]="countrie.nombre">
                                {{countrie.nombre}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </td>
                        <td>
                          <mat-form-field>
                            <mat-select placeholder="Idioma"
                                        name="languageCode"
                                        formControlName="languageCode"
                                        [(ngModel)]="formulario.regionalData.languageCode">
                              <mat-option *ngFor="let languageCodes of viewdata.languageCodes"
                                          [value]="languageCodes">
                                {{languageCodes}}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>

              </mat-expansion-panel>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title i18n>
                    Bienes
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-card>
                  <mat-card-content>

                    <mat-list *ngIf="hasBienes()"
                              fxLayout="column"
                              fxFlex
                              fxLayoutAlign="space-between center">
                      <mat-list-item *ngFor="let bien of formulario.bienes; $index as i"
                                     fxFlex>
                        <div fxLayout="row"
                             fxLayoutAlign="start center"
                             fxFlex>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.descripcion}}</div>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.tipo}}</div>
                          <div fxLayout="row"
                               fxFlex="30%"
                               fxLayoutAlign="center center">{{bien.valor}}</div>
                          <div fxLayout="row"
                               fxFlex="10%"
                               fxLayoutAlign="center center">
                            <button mat-icon-button
                                    (click)="deleteBien($index)">
                              <mat-icon>delete_forever</mat-icon>
                            </button>
                          </div>
                        </div>
                      </mat-list-item>
                    </mat-list>

                    <span *ngIf="!hasBienes()"
                          i18n>No hay bienes cargados.</span>

                  </mat-card-content>
                </mat-card>
                <div class="agregar-bien-container">
                  <div fxLayout="row"
                       fxLayoutAlign="start center">
                    <button mat-button
                            (click)="openDialog()">
                      <mat-icon>add_circle_outline</mat-icon>
                      <span class="agregar-bien-label"
                            i18n>Agregar bien</span>
                    </button>
                  </div>
                </div>
              </mat-expansion-panel>
            </mat-accordion>
          </div>

          <div class="comments-container">
            <mat-form-field fxFlex>
              <mat-label i18n>Observaciones</mat-label>
              <textarea matInput
                        cdkTextareaAutosize
                        cdkAutosizeMinRows="2"
                        name="obs"
                        formControlName="obs"
                        [(ngModel)]="formulario.obs"
                        cdkAutosizeMaxRows="5"></textarea>
            </mat-form-field>
          </div>

          <div fxFlexLayout="row"
               fxLayoutAlign="end center">
            <div class="button-container">
              <button mat-raised-button
                      (click)="cancel()"
                      i18n>Cancelar</button>
            </div>
            <div class="button-container">
              <button mat-raised-button
                      [disabled]="personForm.invalid"
                      (click)="action()"
                      color="primary">{{viewdata.buttonActionText}}</button>
            </div>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>

</div>
